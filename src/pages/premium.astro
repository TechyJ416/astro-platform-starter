---
// src/pages/premium.astro
export const prerender = false;

import Layout from "../layouts/Layout.astro";
import { supabase } from "../lib/supabase";

const session = Astro.locals.session;
const profile = Astro.locals.profile;

const isPremium = profile?.is_premium;

let general = { siteName: 'Banity' };

try {
  const { data: rows } = await supabase.from('site_settings').select('key, value');
  if (rows) {
    for (const row of rows) {
      if (row.key === 'general') general = { ...general, ...row.value };
    }
  }
} catch (e) {}
---

<Layout title="Premium">
  <div class="premium-page">
    <section class="hero-section">
      <div class="hero-content">
        <span class="premium-badge">‚òÖ Premium</span>
        <h1>Unlock Your<br/><span class="accent">Full Potential</span></h1>
        <p>Get exclusive access to premium features and take your creator journey to the next level.</p>
      </div>
    </section>

    <section class="pricing-section">
      <div class="pricing-grid">
        <div class="pricing-card free">
          <div class="card-header">
            <h3>Free</h3>
            <div class="price">
              <span class="amount">$0</span>
              <span class="period">/month</span>
            </div>
          </div>
          <ul class="features-list">
            <li><span class="check">‚úì</span> Apply to campaigns</li>
            <li><span class="check">‚úì</span> Basic profile</li>
            <li><span class="check">‚úì</span> Community access</li>
            <li><span class="check">‚úì</span> Direct payments</li>
            <li class="disabled"><span class="x">√ó</span> Priority applications</li>
            <li class="disabled"><span class="x">√ó</span> Premium badge</li>
            <li class="disabled"><span class="x">√ó</span> Analytics dashboard</li>
            <li class="disabled"><span class="x">√ó</span> Early campaign access</li>
          </ul>
          {session ? (
            isPremium ? (
              <span class="btn btn-secondary btn-full">Current Plan</span>
            ) : (
              <span class="btn btn-secondary btn-full">Your Plan</span>
            )
          ) : (
            <a href="/signup" class="btn btn-secondary btn-full">Get Started</a>
          )}
        </div>

        <div class="pricing-card premium featured">
          <div class="featured-badge">Most Popular</div>
          <div class="card-header">
            <h3>Premium</h3>
            <div class="price">
              <span class="amount">$19</span>
              <span class="period">/month</span>
            </div>
          </div>
          <ul class="features-list">
            <li><span class="check">‚úì</span> Everything in Free</li>
            <li><span class="check highlight">‚úì</span> Priority applications</li>
            <li><span class="check highlight">‚úì</span> Premium badge</li>
            <li><span class="check highlight">‚úì</span> Analytics dashboard</li>
            <li><span class="check highlight">‚úì</span> Early campaign access</li>
            <li><span class="check highlight">‚úì</span> Featured in discover</li>
            <li><span class="check highlight">‚úì</span> Direct brand invites</li>
            <li><span class="check highlight">‚úì</span> Priority support</li>
          </ul>
          {session ? (
            isPremium ? (
              <span class="btn btn-primary btn-full">Current Plan ‚òÖ</span>
            ) : (
              <a href="/dashboard/upgrade" class="btn btn-primary btn-full">Upgrade Now ‚Üí</a>
            )
          ) : (
            <a href="/signup" class="btn btn-primary btn-full">Get Started ‚Üí</a>
          )}
        </div>
      </div>
    </section>

    <section class="benefits-section">
      <div class="section-container">
        <div class="section-header">
          <span class="header-label"><span class="label-line"></span> Why Premium <span class="label-line"></span></span>
          <h2>Supercharge Your Success</h2>
        </div>

        <div class="benefits-grid">
          <div class="benefit-card">
            <div class="benefit-icon">üöÄ</div>
            <h3>Priority Applications</h3>
            <p>Your applications appear at the top, getting seen by brands first.</p>
          </div>

          <div class="benefit-card">
            <div class="benefit-icon">‚è∞</div>
            <h3>Early Access</h3>
            <p>See and apply to new campaigns 24 hours before free users.</p>
          </div>

          <div class="benefit-card">
            <div class="benefit-icon">üìä</div>
            <h3>Advanced Analytics</h3>
            <p>Track your performance with detailed insights and reports.</p>
          </div>

          <div class="benefit-card">
            <div class="benefit-icon">‚ú®</div>
            <h3>Stand Out</h3>
            <p>Premium badge and featured placement in creator discovery.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="faq-section">
      <div class="section-container">
        <div class="section-header">
          <h2>Frequently Asked Questions</h2>
        </div>

        <div class="faq-grid">
          <div class="faq-item">
            <h3>Can I cancel anytime?</h3>
            <p>Yes, you can cancel your premium subscription at any time. You'll keep access until the end of your billing period.</p>
          </div>

          <div class="faq-item">
            <h3>Is there a free trial?</h3>
            <p>We offer a 7-day free trial for new premium subscribers. Cancel before it ends and you won't be charged.</p>
          </div>

          <div class="faq-item">
            <h3>What payment methods are accepted?</h3>
            <p>We accept all major credit cards, debit cards, and PayPal.</p>
          </div>

          <div class="faq-item">
            <h3>Can I switch plans?</h3>
            <p>Yes, you can upgrade or downgrade your plan at any time from your dashboard.</p>
          </div>
        </div>
      </div>
    </section>
  </div>

  <style>
    .premium-page { max-width: 1000px; margin: 0 auto; }

    .hero-section { padding: 4rem 2rem 5rem; text-align: center; }

    .hero-content { max-width: 600px; margin: 0 auto; }

    .premium-badge {
      display: inline-block; padding: 0.5rem 1.25rem;
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      border-radius: 100px; font-size: 0.875rem; font-weight: 700;
      color: #1a1a2e; margin-bottom: 1.5rem;
    }

    .hero-section h1 {
      font-size: clamp(2.5rem, 6vw, 3.5rem); font-weight: 800;
      line-height: 1.1; margin-bottom: 1rem; letter-spacing: -0.02em;
    }

    .accent {
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }

    .hero-section p { font-size: 1.125rem; color: var(--star-dim); }

    .pricing-section { padding: 0 2rem 5rem; }

    .pricing-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 2rem; max-width: 800px; margin: 0 auto; }

    .pricing-card {
      position: relative;
      background: linear-gradient(135deg, rgba(26, 26, 46, 0.7), rgba(8, 8, 18, 0.7));
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 24px; padding: 2rem;
      display: flex; flex-direction: column;
    }

    .pricing-card.featured {
      border-color: rgba(251, 191, 36, 0.4);
      background: linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(26, 26, 46, 0.8));
    }

    .featured-badge {
      position: absolute; top: -12px; left: 50%; transform: translateX(-50%);
      padding: 0.375rem 1rem;
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      border-radius: 100px; font-size: 0.75rem; font-weight: 700; color: #1a1a2e;
    }

    .card-header { text-align: center; margin-bottom: 2rem; padding-top: 0.5rem; }
    .card-header h3 { font-size: 1.25rem; color: var(--star-white); margin-bottom: 0.75rem; }

    .price { display: flex; align-items: baseline; justify-content: center; gap: 0.25rem; }
    .amount { font-size: 3rem; font-weight: 800; color: var(--star-white); }
    .period { color: var(--star-dim); font-size: 1rem; }

    .features-list { list-style: none; flex: 1; margin-bottom: 2rem; }
    .features-list li {
      display: flex; align-items: center; gap: 0.75rem;
      padding: 0.625rem 0; color: var(--star-dim);
      border-bottom: 1px solid rgba(255, 255, 255, 0.04);
    }
    .features-list li:last-child { border-bottom: none; }
    .features-list li.disabled { opacity: 0.5; }

    .check { color: var(--success); font-weight: 700; }
    .check.highlight { color: #fbbf24; }
    .x { color: var(--star-muted); }

    .btn-full { width: 100%; justify-content: center; }

    .section-container { padding: 4rem 2rem; }

    .section-header { text-align: center; margin-bottom: 3rem; }

    .header-label {
      display: inline-flex; align-items: center; gap: 1rem; margin-bottom: 1rem;
      font-size: 0.8125rem; color: var(--cosmic-blue); text-transform: uppercase;
      letter-spacing: 0.15em; font-weight: 600;
    }

    .label-line { width: 30px; height: 1px; background: var(--cosmic-blue); }

    .section-header h2 { font-size: 2rem; font-weight: 800; color: var(--star-white); }

    .benefits-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; }

    .benefit-card {
      background: linear-gradient(135deg, rgba(26, 26, 46, 0.5), rgba(8, 8, 18, 0.5));
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 16px; padding: 1.5rem; text-align: center;
      transition: all 0.3s;
    }

    .benefit-card:hover { border-color: rgba(251, 191, 36, 0.3); }

    .benefit-icon { font-size: 2rem; margin-bottom: 0.75rem; }
    .benefit-card h3 { font-size: 1rem; color: var(--star-white); margin-bottom: 0.5rem; }
    .benefit-card p { font-size: 0.875rem; color: var(--star-dim); line-height: 1.5; }

    .faq-section { border-top: 1px solid rgba(255, 255, 255, 0.04); }

    .faq-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; }

    .faq-item {
      background: linear-gradient(135deg, rgba(26, 26, 46, 0.4), rgba(8, 8, 18, 0.4));
      border: 1px solid rgba(255, 255, 255, 0.04);
      border-radius: 16px; padding: 1.5rem;
    }

    .faq-item h3 { font-size: 1rem; color: var(--star-white); margin-bottom: 0.5rem; }
    .faq-item p { font-size: 0.875rem; color: var(--star-dim); line-height: 1.6; }

    @media (max-width: 768px) {
      .pricing-grid { grid-template-columns: 1fr; }
      .benefits-grid { grid-template-columns: 1fr; }
      .faq-grid { grid-template-columns: 1fr; }
    }
  </style>
</Layout>
